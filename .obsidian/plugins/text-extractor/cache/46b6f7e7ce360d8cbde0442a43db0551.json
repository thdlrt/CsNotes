{"path":"docs/å­¦æ ¡è¯¾ç¨‹/å½’æ¡£è¯¾ç¨‹/å¤§æ•°æ®/è¯¾ä»¶/12 MapReduceæ•°æ®æŒ–æ˜åŸºç¡€ç®—æ³• (III).pdf","text":"MapReduceæ•°æ®æŒ–æ˜åŸºç¡€ç®—æ³•(III) æ‘˜è¦ Â¨ é¢‘ç¹é¡¹é›†æŒ–æ˜ç®—æ³• Â¨ åº”ç”¨æ¡ˆä¾‹ 2 é¢‘ç¹é¡¹é›†æŒ–æ˜ Â¨ å…³è”è§„åˆ™æˆ–é¢‘ç¹é¡¹é›† Â¤ é¢‘ç¹é¡¹å¯ä»¥çœ‹ä½œæ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå¯¹è±¡çš„â€œäº²å¯†â€ç¨‹åº¦ï¼Œå¦‚æœåŒæ—¶å‡ºç°çš„ æ¬¡æ•°å¾ˆå¤šï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæˆ–å¤šä¸ªå¯¹è±¡å¯ä»¥è®¤ä¸ºæ˜¯é«˜å…³è”æ€§çš„ã€‚å½“è¿™äº›é«˜ å…³è”æ€§å¯¹è±¡çš„é¡¹é›†å‡ºç°æ¬¡æ•°æ»¡è¶³ä¸€å®šé˜ˆå€¼æ—¶å³ç§°å…¶ä¸ºé¢‘ç¹é¡¹ã€‚ Â¨ ç»å…¸å®ä¾‹ï¼šè´­ç‰©ç¯®åˆ†æ Â¤ å•¤é…’å’Œå°¿å¸ƒ 3 é¢‘ç¹é¡¹é›† Â¨ mä¸ªé¡¹çš„é›†åˆï¼š I = {ğ¼!, ğ¼\", â€¦ , ğ¼#} Â¨ nä¸ªäº‹åŠ¡çš„æ•°æ®åº“ï¼šD = {ğ‘‡!, ğ‘‡\", â€¦ , ğ‘‡$}ï¼Œå…¶ä¸­ğ‘‡%æ˜¯Içš„éç©ºå­é›†ã€‚ Â¨ å…³è”è§„åˆ™ï¼šğ‘‹ â‡’ ğ‘Œ ï¼Œå…¶ä¸­Xï¼ŒYæ˜¯Içš„å­é›†ï¼Œå¹¶ä¸”ğ‘‹ âˆ© ğ‘Œ = âˆ… Â¨ å…³è”è§„åˆ™çš„ğ‘‹ â‡’ ğ‘Œçš„æ”¯æŒåº¦æ˜¯æŒ‡Dä¸­äº‹åŠ¡åŒ…å«ğ‘‹ âˆª ğ‘Œçš„ç™¾åˆ†æ¯”ï¼Œç½® ä¿¡åº¦æ˜¯æŒ‡åŒ…å«ğ‘‹çš„äº‹åŠ¡ä¸­åŒæ—¶åŒ…å«Yçš„ç™¾åˆ†æ¯”ï¼Œä¹Ÿå°±æ˜¯æ¡ä»¶æ¦‚ç‡ P(Y|X) Â¨ å¦‚æœæŸä¸€è§„åˆ™ğ‘‹ â‡’ ğ‘Œçš„ç½®ä¿¡åº¦å’Œæ”¯æŒåº¦éƒ½é«˜äºæŸä¸ªé˜ˆå€¼ï¼Œé‚£ä¹ˆå¯ ä»¥è®¤ä¸ºXï¼ŒYå…·æœ‰å…³è”æ€§ã€‚ 4 é¢‘ç¹é¡¹é›† Â¨ æŠŠæ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„Xï¼ŒYç»„æˆä¸€ä¸ªé¡¹é›†Aï¼Œåˆ™å¯ä»¥è®¤ä¸ºï¼Œæ•°æ®åº“D ä¸­åŒ…å«Açš„äº‹åŠ¡è¶…è¿‡äº†æŸä¸ªæœ€å°æ”¯æŒåº¦ã€‚è€Œæ‰€è°“é¢‘ç¹é¡¹é›†æŒ–æ˜ï¼Œ å°±æ˜¯å°†æ‰€æœ‰æ»¡è¶³é¡¹æ•°ä¸ºæŸä¸ªå›ºå®šæ•´æ•°kï¼Œä¸”æ”¯æŒåº¦é«˜äºæŸé˜ˆå€¼çš„ é¡¹é›†è®¡ç®—å‡ºæ¥ã€‚ Â¨ ç»å…¸ç®—æ³•ï¼šAprioriï¼ŒFP-growthï¼ŒSONç­‰ã€‚ 5 Aprioriç®—æ³• Â¨ é€šè¿‡å¤šè½®è¿­ä»£çš„æ–¹æ³•æ¥é€æ­¥æŒ–æ˜é¢‘ç¹é¡¹é›† Â¨ å…ˆéªŒåŸç†ï¼š Â¤ é¢‘ç¹é¡¹é›†çš„ä»»ä½•éç©ºå­é›†éƒ½æ˜¯é¢‘ç¹çš„ã€‚ Â¤ éé¢‘ç¹é¡¹é›†çš„ä»»ä½•è¶…é›†éƒ½æ˜¯éé¢‘ç¹çš„ã€‚ 6 Aprioriç®—æ³• L!={frequent 1-itemsets}; For (k=2; L\"#! â‰  null; k++} do begin //å¤šè½®è¿­ä»£è¿‡ç¨‹ C\"=apriori-gen(L\"#!); //å€™é€‰k-é¡¹é›† for each transaction t âˆˆ D do begin C$ = subset(C\", t); //ç”Ÿæˆå­é›† for each candidate c âˆˆ C$ do c. count ++; //è®¡ç®—å®é™…çš„æ”¯æŒåº¦ end L\"={ c= C\" | c. count â‰¥ minsup } end Answer = U\"L\" 7 Aprioriç®—æ³• 8 Aprioriå¹¶è¡ŒåŒ–ç®—æ³•è®¾è®¡ Â¨ ä¸»è¿›ç¨‹æ‰«æäº‹åŠ¡æ•°æ®åº“ï¼Œä»åŸå§‹æ•°æ®é›†ä¸­äº§ç”Ÿå€™é€‰1-é¡¹é›† Â¨ ç”±å€™é€‰1-é¡¹é›†ä¸åŸå§‹æ•°æ®é›†è¿›è¡Œå¯¹æ¯”ï¼Œç®—å‡ºæ¯ä¸ªé¡¹é›†çš„æ”¯æŒåº¦ï¼Œè¿™äº›æ”¯æŒåº¦ä¸ ç¨‹åºä¸­ç»™å®šçš„æ”¯æŒåº¦è¿›è¡Œå¯¹æ¯”ï¼Œå¾—å‡ºé¢‘ç¹1-é¡¹é›† Â¨ ç”±é¢‘ç¹1-é¡¹é›†äº§ç”Ÿå€™é€‰2-é¡¹é›†ï¼Œå¹¶é€šè¿‡ä¸åŸå§‹æ•°æ®é›†æ¯”è¾ƒå¾—åˆ°é¢‘ç¹2-é¡¹é›† Â¨ é€æ¬¡è¿­ä»£ç›´åˆ°äº§ç”Ÿå€™é€‰k-é¡¹é›†ï¼Œå€™é€‰k-é¡¹é›†ä¸åŸå§‹æ•°æ®é›†å¯¹æ¯”ï¼Œå¦‚æœå­˜åœ¨é¢‘ç¹ k-é¡¹é›†ï¼Œåˆ™ç»§ç»­è¿­ä»£æ‰§è¡Œï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æœ€ç»ˆå¾—åˆ°é¢‘ç¹(k-1)-é¡¹é›† 9 Aprioriå¹¶è¡ŒåŒ–ç®—æ³•è®¾è®¡ Â¨ ç¬¬ä¸€è½®è¿­ä»£ï¼šè®¡ç®—é¢‘ç¹1-é¡¹é›† Â¨ Mapé˜¶æ®µ Â¤ è¾“å…¥keyï¼šäº‹åŠ¡æ•°æ®åº“æ¯è¡Œé¦–å­—ç¬¦ç›¸å¯¹äºæ–‡æœ¬æ–‡ä»¶çš„é¦–åœ°å€åç§»ï¼›è¾“å…¥valueï¼šå­˜å‚¨åœ¨äº‹åŠ¡æ•° æ®åº“æ–‡ä»¶ä¸­çš„ä¸€è¡Œæ•°æ® Â¤ è¾“å‡ºkeyï¼šå€™é€‰1-é¡¹é›† è¾“å‡ºvalueï¼š1 Map Task: For each transaction t in Si Map(line offset, t) For each item I in t Emit (I, 1); End For each End Map() End For each End Map 10 Aprioriå¹¶è¡ŒåŒ–ç®—æ³•è®¾è®¡ Â¨ Reduceé˜¶æ®µ Â¤ è¾“å‡ºkeyï¼šé¢‘ç¹1-é¡¹é›†ï¼›è¾“å‡ºvalueï¼šå‡ºç°çš„æ¬¡æ•° Reduce Task: Reduce(key2, value2) Sum = 0; While (value2.hasNext()) Sum += value2.hasNext(); End While If (Sum>=Minsup) Emit (key2, sum) //å¾—åˆ°é¢‘ç¹1-é¡¹é›† End If End Reduce 11 Aprioriå¹¶è¡ŒåŒ–ç®—æ³•è®¾è®¡ Â¨ ç¬¬kè½®MapReduceè¿­ä»£ï¼šè®¡ç®—k-é¢‘ç¹é¡¹é›† Â¨ Mapé˜¶æ®µ Â¤ è¾“å…¥<key,value>å¯¹ä¸ºï¼šäº‹åŠ¡æ•°æ®åˆ†ç‰‡ä¸­çš„æ¯ä¸ªäº‹åŠ¡æ•°æ®ã€‚è¿™ä¸ªé˜¶æ®µä¼š ä»é¢‘ç¹(k-1)-é¡¹é›†å¾—åˆ°å€™é€‰k-é¡¹é›†ï¼Œé¢‘ç¹(k-1)-é¡¹é›†å­˜æ”¾åœ¨Distributed Cacheä¸­ä»¥ä¾¿æ¯ä¸ªMapèŠ‚ç‚¹å…±äº«è¯»å–å’Œä½¿ç”¨ã€‚ä¸ºäº†äº§ç”Ÿå€™é€‰k-é¡¹é›†ï¼ŒåŒ… æ‹¬è¿æ¥å’Œå‰ªæè¿‡ç¨‹ã€‚ Â¤ è¾“å‡ºkeyä¸ºå€™é€‰k-é¡¹é›†ï¼Œvalueä¸ºå…¶å‡ºç°çš„æ¬¡æ•°ã€‚ 12 Aprioriå¹¶è¡ŒåŒ–ç®—æ³•è®¾è®¡ Map Task: Read Lk-1 from HDFS file Ck = ap_gen(Lk-1) //self joinè¿æ¥è¿‡ç¨‹ For each transaction t in Si Map(line offset, t) Ct = subset (Ck , t) //è·å–åœ¨åŸå§‹äº‹åŠ¡æ•°æ®ä¸­å‡ºç°çš„å€™é€‰é¡¹é›† For each item c in Ct Emit (c, 1); End For each End Map() End For each End Map 13 Aprioriå¹¶è¡ŒåŒ–ç®—æ³•è®¾è®¡ Â¨ Reduceé˜¶æ®µ Â¤ è¾“å‡ºkeyï¼šé¢‘ç¹k-é¡¹é›†ï¼›è¾“å‡ºvalueï¼šå‡ºç°çš„æ¬¡æ•° Reduce Task: Reduce(key2, value2) Sum = 0; While (value2.hasNext()) Sum += value2.hasNext(); End While If (Sum>=Minsup) Emit (key2, sum) //å¾—åˆ°é¢‘ç¹k-é¡¹é›† End If End Reduce 14 åŸºäºå­é›†æ±‚å–çš„é¢‘ç¹é¡¹é›†æŒ–æ˜ç®—æ³• Â¨ ä¸€ä¸ªé¢‘ç¹é¡¹é›†Få¿…ç„¶æ˜¯Dä¸­æŸä¸ªäº‹åŠ¡çš„å­é›†ï¼Œå³åªè¦æ ¹æ®äº‹åŠ¡æ•° æ®æœ¬èº«å°±å¯ä»¥è®¡ç®—é¢‘ç¹é¡¹é›†ã€‚ Â¨ å‡è®¾æ•°æ®åº“ä¸ºDï¼Œäº‹åŠ¡ä¸ºTï¼Œé¡¹é›†å¤§å°ä¸ºk Â¤ é¦–å…ˆæ‰«ææ•°æ®åº“ï¼Œå¯¹æ•°æ®åº“ä¸­çš„æ¯ä¸€ä¸ªäº‹åŠ¡åšå¦‚ä¸‹æ“ä½œï¼šå°†è¯¥äº‹åŠ¡æ‰€ æœ‰å¤§å°ä¸ºkçš„å­é›†æ±‚å‡ºæ¥(Mapper) Â¤ ç„¶åï¼Œç»Ÿè®¡è¾“å‡ºæ‰€æœ‰å­é›†çš„ä¸ªæ•°ï¼Œå¦‚æœæŸä¸ªå­é›†çš„ä¸ªæ•°è¶…è¿‡äº†æŸä¸€é˜ˆ å€¼Sï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¤ä¸ºè¿™ä¸ªå­é›†æ˜¯é¢‘ç¹é¡¹é›†ï¼Œå°†æ‰€æœ‰è¿™æ ·çš„å­é›†è¾“å‡º å³å¯(Reducer) 15 åŸºäºå­é›†æ±‚å–çš„é¢‘ç¹é¡¹é›†æŒ–æ˜ç®—æ³• Â¨ Mapper Class MiningMapper{ map(T){ //Tä¸ºæ•°æ®åº“ä¸­çš„ä¸€ä¸ªäº‹åŠ¡ /** æ±‚å‡ºTæ‰€æœ‰å¤§å°ä¸ºkçš„å­é›† **/ /** è‹¥Tçš„é¡¹æ•°å°äºkï¼Œåˆ™å­é›†æ•°ä¸º0 **/ Subsets = FindSubsets(T, k); for (i=0; i<Subsets.size(); i++) subset = Subsets.get(i) emit(subset, 1) } } 16 åŸºäºå­é›†æ±‚å–çš„é¢‘ç¹é¡¹é›†æŒ–æ˜ç®—æ³• Â¨ Reducer Class MiningReducer{ reduce(key, value_list){ sum = 0; while(value_list.hasNext()) sum += value_list.next().get(); if(sum > minSupport) emit(key, sum); } } 17 SONç®—æ³• Â¨ æœ‰é™æ‰«æï¼šæœ€å¤šä¸¤éä¹‹å†…å‘ç°å…¨éƒ¨æˆ–è€…å¤§éƒ¨åˆ†é¢‘ç¹é¡¹é›†ã€‚åªåˆ©ç”¨æ•° æ®æŠ½æ ·æ ·æœ¬è€Œä¸æ˜¯å…¨éƒ¨æ•°æ®é›†è¿›è¡Œè®¡ç®—ã€‚ Â¨ åŸºæœ¬æ€è·¯ï¼šå…ˆé‡‡æ ·éƒ¨åˆ†æ ·æœ¬ï¼Œåœ¨å…¶ä¸Šè¿è¡ŒAprioriç®—æ³•ï¼Œå¹¶è°ƒæ•´ç›¸åº” æ”¯æŒåº¦é˜ˆå€¼ã€‚é‡‡æ ·å¾—åˆ°çš„å­æ•°æ®é›†ç›´æ¥å­˜å…¥ä¸»å­˜ï¼Œä¹‹åæ‰«ææ•°æ®è‡ª å·±ä¸ç”¨å†æ¬¡è¿›è¡ŒI/Oæ“ä½œã€‚ Â¤ ä¾‹å¦‚é€‰æ‹©1%çš„æ ·æœ¬ï¼Œæ”¯æŒåº¦é˜ˆå€¼ä¸ºs/100 Â¨ æŠ½æ ·å¯èƒ½å¯¼è‡´å®Œæ•´æ•°æ®é›†ä¸Šçš„é¢‘ç¹é¡¹åœ¨æ ·æœ¬ä¸­ä¸é¢‘ç¹(false negative)ï¼Œæ ·æœ¬ä¸­é¢‘ç¹ä½†åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šä¸é¢‘ç¹(false positive) 18 SONç®—æ³• Â¨ SONç®—æ³•åŒæ—¶é¿å…äº†false negativeså’Œfalse positivesï¼Œæ‰€å¸¦æ¥çš„ä»£ ä»·æ˜¯éœ€è¦ä¸¤æ¬¡æ‰«æã€‚ Â¨ åŸºæœ¬æ€æƒ³ï¼šå°†è¾“å…¥æ–‡ä»¶åˆ’åˆ†æˆ1/pä¸ªå—(pä¸ºæ ·æœ¬å å…¨éƒ¨æ•°æ®é›†çš„ æ¯”ä¾‹)ï¼Œå°†æ¯ä¸ªæ–‡ä»¶å—ä½œä¸ºä¸€ä¸ªæ ·æœ¬ï¼Œå¹¶æ‰§è¡ŒAprioriç®—æ³•ã€‚åŒæ ·é€‚ ç”¨p*sä½œä¸ºå…¶é˜ˆå€¼ã€‚å°†æ¯ä¸ªå—æ‰¾åˆ°çš„é¢‘ç¹é¡¹é›†æ”¾åˆ°ç£ç›˜ä¸Šã€‚ 19 SONç®—æ³• Â¨ ç¬¬ä¸€æ­¥ï¼šæ‰¾åˆ°å±€éƒ¨é¢‘ç¹é¡¹é›† Â¤ ä¸€æ—¦æ‰€æœ‰çš„å—æŒ‰æ­¤æ–¹å¼è¢«å¤„ç†ï¼Œå°†é‚£äº›åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªå—ä¸­è¢«é€‰ä¸­çš„é¢‘ç¹é¡¹ é›†æ”¶é›†èµ·æ¥ä½œä¸ºå€™é€‰é¢‘ç¹é¡¹é›†ã€‚æ³¨æ„ï¼Œå¦‚æœä¸€ä¸ªé¡¹é›†åœ¨æ‰€æœ‰çš„å—ä¸­éƒ½ä¸æ˜¯ é¢‘ç¹é¡¹é›†ï¼Œå³å®ƒåœ¨æ¯ä¸ªå—ä¸­çš„æ”¯æŒåº¦éƒ½ä½äºp*sã€‚å› ä¸ºå—æ•°ä¸º1/pï¼Œæ‰€ä»¥ï¼Œæ•´ ä½“çš„æ”¯æŒåº¦ä¹Ÿå°±ä½äº(1/p)*p*s=sã€‚è¿™æ ·ï¼Œæ¯ä¸ªé¢‘ç¹é¡¹é›†å¿…ç„¶ä¼šå‡ºç°åœ¨è‡³å°‘ä¸€ ä¸ªå—çš„é¢‘ç¹é¡¹é›†ä¸­ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šï¼ŒçœŸæ­£çš„é¢‘ç¹é¡¹ä¸€å®šå…¨åœ¨å€™é€‰é¢‘ ç¹é¡¹é›†ä¸­ï¼Œå› æ­¤è¿™é‡Œæ²¡æœ‰false negativesã€‚ Â¨ ç¬¬äºŒæ­¥ï¼šæ‰¾å‡ºå…¨å±€é¢‘ç¹é¡¹é›† Â¤ è®¡ç®—æ‰€æœ‰çš„å€™é€‰é¢‘ç¹é¡¹é›†ï¼Œé€‰æ‹©é‚£äº›æ”¯æŒåº¦è‡³å°‘ä¸ºsçš„ä½œä¸ºé¢‘ç¹é¡¹é›†ã€‚ 20 SONç®—æ³•å¹¶è¡ŒåŒ– Â¨ ç¬¬ä¸€ä¸ªMap å‡½æ•°ï¼šä½¿ç”¨å­é›†ï¼Œå¹¶åœ¨å­é›†ä¸Šä½¿ç”¨Aprioriç®—æ³•æ‰¾å‡ºæ¯ä¸ªé¡¹é›†çš„é¢‘ç¹åº¦ã€‚å°†æ”¯æŒåº¦ ä»sé™ä¸ºp*sï¼Œè¾“å‡º(F,1)ï¼ŒFä¸ºè¯¥æ ·æœ¬çš„é¢‘ç¹é¡¹é›†ã€‚ Â¨ ç¬¬ä¸€ä¸ªReduceå‡½æ•°ï¼šäº§ç”Ÿé‚£äº›å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡çš„keyï¼ˆå³é¡¹é›†ï¼‰ï¼Œè¾“å‡ºå€™é€‰é¡¹é›†ã€‚ Â¨ ç¬¬äºŒä¸ªMapå‡½æ•°ï¼šæ¥å—ç¬¬ä¸€ä¸ªReduceå‡½æ•°çš„æ‰€æœ‰è¾“å‡ºå’Œè¾“å…¥æ•°æ®æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œæ¯ä¸ªMapä»»åŠ¡ è®¡ç®—æ¯ä¸ªå€™é€‰é¡¹é›†åœ¨å½“å‰æ•°æ®é›†ä¸Šå‡ºç°çš„æ¬¡æ•°ï¼Œè¾“å‡ºä¸º(C,v)ç»„æˆçš„é›†åˆï¼Œå…¶ä¸­Cæ˜¯ä¸€ä¸ªå€™é€‰é›†ï¼Œ væ˜¯Cåœ¨æœ¬Mapä»»åŠ¡æ‰€åˆ†é…æ•°æ®ä¸Šçš„æ”¯æŒåº¦ã€‚ Â¨ ç¬¬äºŒä¸ªReduceå‡½æ•°ï¼šå°†åˆ†é…çš„é¡¹é›†ä½œä¸ºKeyï¼Œå¹¶å°†å…³è”çš„å€¼æ±‚å’Œã€‚æœ€ç»ˆå¾—åˆ°æ¯ä¸ªReduceä»»åŠ¡æ‰€ åˆ†é…çš„æ¯ä¸ªé¡¹é›†åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šçš„å…¨éƒ¨æ”¯æŒåº¦ã€‚é‚£äº›å€¼æ±‚å’Œåä¸ä½äºsçš„é¡¹é›†æ˜¯æ•´ä¸ªæ•°æ®é›†ä¸Š çš„é¢‘ç¹é¡¹é›†ï¼ŒReduceä»»åŠ¡ä¼šå°†è¿™äº›é¡¹é›†åŠå…¶è®¡æ•°å€¼è¾“å‡ºã€‚ 21 åº”ç”¨é¢†åŸŸ Â¨ è´­ç‰©ç¯®åˆ†æ Â¨ ä¿¡ç”¨å¡äº¤æ˜“åˆ†æ Â¨ ç”µè¯å‘¼å«æ¨¡å¼åˆ†æ Â¨ åŒ»ç–—ä¿é™©æ¬ºè¯ˆè¯†åˆ« Â¨ ç”µä¿¡æœåŠ¡äº¤æ˜“åˆ†æ Â¨ å¤§å‹åœ¨çº¿é›¶å”®å•†çš„æ¯æ—¥/å‘¨äº¤æ˜“åˆ†æ Â¨ â€¦â€¦ 22 åŸºäºå…³è”è§„åˆ™æŒ–æ˜çš„å›¾ä¹¦æ¨èç®—æ³• Â¨ åŸºäºAprioriåŸºæœ¬ç®—æ³•å®ç° Â¤ é‡‡ç”¨ç±»ä¼¼å•è¯è®¡æ•°çš„è¿‡ç¨‹å¹¶è¡Œæ‰«ææ•°æ®åº“ï¼Œæ‰¾å‡ºæ»¡è¶³æœ€å°æ”¯æŒåº¦çš„1- é¢‘ç¹é¡¹é›†L1 Â¤ L1é€šè¿‡è‡ªèº«è¿æ¥äº§ç”Ÿ2-å€™é€‰é¡¹é›†C2ï¼Œé‡‡ç”¨å€™é€‰é¡¹é›†æ”¯æŒåº¦çš„å¹¶è¡ŒåŒ–ç»Ÿ è®¡æ–¹æ³•ç»Ÿè®¡C2çš„æ”¯æŒåº¦ï¼Œè¡Œæˆ2-é¢‘ç¹é¡¹é›†L2ï¼›ä»¥æ­¤ç±»æ¨ï¼ŒL2äº§ç”ŸL3ï¼Œå¦‚ æ­¤è¿­ä»£å¾ªç¯ï¼Œç›´åˆ°å®Œæˆk-é¢‘ç¹é¡¹é›†çš„è®¡ç®—ã€‚ 23 åŸºäºå…³è”è§„åˆ™æŒ–æ˜çš„å›¾ä¹¦æ¨èç®—æ³• Â¨ æ•°æ®è·å–ï¼šè±†ç“£è¯»ä¹¦ç½‘ç«™API Â¤ è·å–ä¹¦ç±ä¿¡æ¯ Â¤ è·å–ç‰¹å®šä¹¦ç±çš„æ‰€æœ‰è¯„è®º Â¨ ç®—æ³•å®ç°ï¼š Â¤ è®¡ç®—æ¯æœ¬å›¾ä¹¦çš„æ”¯æŒåº¦ Â¤ ç»Ÿè®¡2-é¢‘ç¹é¡¹é›†ä¸­æ¯ä¸ªå…ƒç»„çš„æ”¯æŒåº¦ Â¤ è®¡ç®—æ¯ä¸ª2-é¢‘ç¹é¡¹é›†å…ƒç»„ä¸­å›¾ä¹¦Aåˆ°å›¾ä¹¦Bçš„ç½®ä¿¡åº¦ 24 å›¾ä¹¦æ¨èç³»ç»Ÿ 25 å…¨æ–‡æœç´¢å¼•æ“ç®—æ³•è®¾è®¡å®ç° 26 What happens after you press enter? ä½“ç³»ç»“æ„ 27 DocumentsQuery Hits Representation Function Representation Function Query Representation Document Representation Comparison Function Index offlineonline document acquisition (e.g., web crawling) åŠŸèƒ½ 28 Documents Inverted Index Bag of Words case folding, tokenization, stopword removal, stemming syntax, semantics, word knowledge, etc. ç®€å•çš„å€’æ’ç´¢å¼•ç¤ºä¾‹ 29 1 1 1 2 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 2 3 1 1 1 4 1 1 1 2 1 1 2 1 blue cat egg fish green ham hat one 1 1 1 1 1 1 2 1 blue cat egg fish green ham hat one 1 1red 1 1two 1red 1two one fish, two fish Doc 1 red fish, blue hat Doc 2 cat in the hat Doc 3 green eggs and ham Doc 4 3 4 1 4 4 3 2 1 2 2 1 12 MapReduceâ€™s Roleâ€¦ 30 Not so good â€¦ 1.must have sub-second response time 2.for the web, only need relatively few results Indexing Problem Retrieval Problem Character Description Suitable? Perfect ! 1.scalability 2.relatively fast 3.batch operation 4.updates may not be important 5.crawling is a challenge in itself å°ç™¾åˆå…¨æ–‡æœç´¢å¼•æ“è®¾è®¡ä¸å®ç° Â¨ å·¥ä½œæµç¨‹ Â¤ Web pageçˆ¬å–å’ŒæŒ–æ˜ Â¤ å»ºç«‹ç´¢å¼• Â¤ Webä¿¡æ¯æ£€ç´¢æ¥å£ 31 å¼•è‡ªï¼šé»„å®œåï¼Œé¡¾è£ ã€ŠMapReduceã€‹è¯¾ç¨‹è®²ä¹‰ 2011å¹´ 32 Response Query String Web Page 0 Web Page 1 Web Page n Crawl && Info Mining Formated Files /Content /Vice Info Inverted Index && Ranking <DID, Rank> â€¦â€¦ <DID, Rank> â€¦â€¦ <DID, Rank> â€¦â€¦ JSP Page Split Term0,Term1â€¦Term n Search & Merge Target DID Result List Title Context Author URL Hot token 1 token 0token n Index For Indices Crawler Web Retrival Map/Reduce Crawlerç­–ç•¥ï¼šDFS Post 1 Post n Post 0 Title in here BBS Lily Title in here Section 12Title in here section0 Title in here section2Title in here section1 â€¦â€¦â€¦ Title in here Board 0 Board 1 Title in here Board nâ€¦â€¦â€¦ â€¦â€¦â€¦ -Traversal catalog links to get the content; -Automatic link to Next Page and do the routine job. tips Minerç­–ç•¥ï¼šRegex 34 Use HtmlParser To get Tagsâ€™ Content Extract Info by regex Store in a designed pattern [Each post will be stored in a line as the pattern blew] URLâ€™/007â€™hotâ€™/007â€™auhtorâ€™/007â€™titleâ€™/007â€™content å»ºç«‹ç´¢å¼• 35 Run a series of Map/Reduce operations to generate Inverted Indices with rank and position info. Indexing Process Txt_Filter Partition Index Table Inverted Index Index For Indices å€’æ’ç´¢å¼•ï¼šPosting Info 36 1.TF-IDF (Term Frequency-Inverse Document Frequency): 2.Positions info do not need any calculation. They can be record as a Integer Pair like(StartIndex, EndIndex). Posting Info â€¢| D | : total number of documents in the corpus â€¢ : number of documents where the term ti appears (that is ) Target of Web Retrieval Interface 37 Make an Interface which accept userâ€™s query and response search results. 1. Restrict the query string; 2. Sort search result dynamically; 3. Response results page by page. Web Retrieval Interface Javascript+HTML Tomcat+Servlet Technics: Sort Pages 38 Term 0 Term 2 Term 1 Here is a demo. Doc1 10 Doc3 90 Doc7 20 Query String Word Segment Doc2 20 Doc7 80 Doc5 15 Doc3 05 Doc2 40 Doc6 40 Merge Rank Again Doc7 100 Doc3 95 Doc6 40 Doc2 40 Doc5 15 Doc1 10 ä¼˜åŒ– 39 a)For each term only top 1500 DID are reserved at most. b)Use TreeMap to sort.. Reduce Sort Time Reduce I/O operations â€¦â€¦Cache Strategy Optimization measures in different areas. a)Response Page is created dynamically. b)Each time return 10 records. .......... a) Put some hot Inverted Index file in the memory. b) Cache replacement --- LRU Maybe Google & Baidu has done... 40 Parallelly Word Segment User's query Rank 3.A better rank strategy :To describe the relationship between a token and DID precisely 4.Record each user's query string; a) feed back to Word Segment b) Provide remind function.(By input change event) 1. Search Stuff parallelly 2. An outstanding Word Segment Algorithm â€¦â€¦. â€¦â€¦ å±•ç¤º 41 å…¶å®ƒMapReduceåº”ç”¨æ¡ˆä¾‹ Â¨ å¤§è§„æ¨¡åŸºå› åºåˆ—æ¯”å¯¹ Â¨ å¤§è§„æ¨¡åŸå¸‚è·¯å¾„è§„åˆ’ Â¨ å¤§è§„æ¨¡é‡å¤æ–‡æ¡£æ£€æµ‹ Â¨ åŸºäºå†…å®¹çš„å¹¶è¡ŒåŒ–å›¾åƒæ£€ç´¢ç®—æ³•ä¸å¼•æ“ Â¨ å¤§è§„æ¨¡å¾®åšä¼ æ’­åˆ†æ Â¨ åŸå¸‚æ™ºèƒ½äº¤é€šç»¼åˆåº”ç”¨ Â¨ â€¦â€¦ 42 THANK YOU","libVersion":"0.3.2","langs":""}